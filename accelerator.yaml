accelerator:
  displayName: Frontend UX for Online Stores
  description: Accelerator to create fronted UX for online Stores
  iconUrl: https://raw.githubusercontent.com/dektlong/dekt-images/main/reactjs-logo.png
  tags:
  - onlinestore-dev

  options:
  
  #deployment
  - name: appDeploymentType
    label: App deployment config
    description: Type of deployment configurations
    required: true
    defaultValue: tap
    inputType: select
    choices:
      - value: tap
        text: TAP workload
      - value: k8s
        text: K8s deployment
      - value: cf
        text: Cloud Foundry manifest
        
  - name: gitRepo
    label: Git repo
    inputType: text
    required: true
    dataType: string
    defaultValue: https://github.com/dektlong/dekt4pets-frontend
    
  #apis groups
  - name: firstApiGroup
    label: First level API group
    description: Name of the first level API group
    defaultValue: apiGroup1
    required: true
    defaultValue: apiGroup1
  - name: secondApiGroup
    label: Second level API group
    display: true
    description: Name of the second API group
    defaultValue: apiGroup2
  - name: thirdApiGroup
    label: Third  level API group
    description: Name of the third API group
    defaultValue: apiGroup3
  - name: forthApiGroup
    label: Forth level API group
    description: Name of the forth API group
    defaultValue: apiGroup4
  - name: fifthApiGroup
    label: Fifth level API group
    description: Name of the Fifth API group
    defaultValue: apiGroup5

  #apis samples
  - name: apiSamples
    inputType: checkbox
    label: API definitions format
    description: API developement samples
    display: true
    dataType: [string]
    defaultValue:
      - k8s
    choices:
      - value: k8s  
        text: YAML
      - value: cf
        text: JSON

engine:
  merge:
    #generic transformations
    - includes: ["**"]
      excludes: [ "config/**" ]
      chain:
        - type: ReplaceText
          substitutions:
            - text: app-name
              with: "#artifactId"
  #deployment transformations
    - includes: [ "config/workload.yaml" ]
      condition: "#appDeploymentType == 'tap'"
      chain:
        - type: YTT
    - includes: [ "config/deployment.yaml" ]
      condition: "#appDeploymentType == 'k8s'"
      chain:
        - type: YTT
    - includes: [ "config/deployment.yaml", "config/skaffold.yaml"]
      condition: "#appDeploymentType == 'k8sSkaffold'"
      chain:
        - type: YTT
    - includes: [ "config/manifest.yaml"]
      condition: "#appDeploymentType == 'cf'"
      chain:
        - type: YTT
    #api-grid transformations
    - includes: [ "config/gateway-dev.yaml", "config/routes.yaml" ]
      condition: "#apiSamples.contains('k8s')"
      chain:
        - type: YTT
    - includes: [ "config/gateway-dev.json", "config/routes.json" ]
      condition: "#apiSamples.contains('cf')"
      chain:
        - type: ReplaceText
          substitutions:
          - text: app-name
            with: "#artifactId"
          - text: api-group1
            with: "#firstApiGroup"
          - text: api-group2
            with: "#secondApiGroup"
